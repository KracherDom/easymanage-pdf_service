{
  "name": "pdf-service",
  "description": "PDF Generation Microservice",
  "spec": {
    "kind": "Deployment",
    "type": "combined",
    "buildSettings": {
      "dockerfile": {
        "buildEngine": "kaniko",
        "dockerFilePath": "/Dockerfile",
        "dockerWorkDir": "/"
      }
    },
    "runtimeSettings": {
      "resources": {
        "limits": {
          "memory": "1Gi",
          "cpu": "0.5"
        },
        "requests": {
          "memory": "512Mi",
          "cpu": "0.25"
        }
      },
      "replicas": {
        "min": 1,
        "max": 3
      },
      "autoscaling": {
        "enabled": true,
        "targetCPUUtilizationPercentage": 80,
        "targetMemoryUtilizationPercentage": 80
      }
    },
    "ports": [
      {
        "name": "http",
        "internalPort": 3001,
        "protocol": "HTTP",
        "public": true
      }
    ],
    "healthChecks": {
      "livenessProbe": {
        "httpGet": {
          "path": "/health",
          "port": 3001
        },
        "initialDelaySeconds": 30,
        "periodSeconds": 10,
        "timeoutSeconds": 5,
        "failureThreshold": 3
      },
      "readinessProbe": {
        "httpGet": {
          "path": "/health",
          "port": 3001
        },
        "initialDelaySeconds": 10,
        "periodSeconds": 5,
        "timeoutSeconds": 3,
        "failureThreshold": 3
      }
    }
  },
  "variables": {
    "NODE_ENV": {
      "value": "production"
    },
    "PORT": {
      "value": "3001"
    },
    "API_KEY": {
      "secretRef": "PDF_SERVICE_API_KEY"
    },
    "ALLOWED_ORIGINS": {
      "value": "*"
    },
    "PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD": {
      "value": "0"
    }
  }
}
